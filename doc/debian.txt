# $Header: /data/zender/nco_20150216/nco/doc/debian.txt,v 1.1 2003-03-15 06:17:49 zender Exp $ -*-text-*-

# Purpose: Debian information for NCO netCDF Operators project
# Notes describe procedure to manipulate Debian-specific distribution

Debian:		    http://packages.debian.org/unstable/math/nco.html
Gentoo:		    http://gentoo-stable.iq-computing.de/browse?type=version&category=app-sci&package=nco&version=2.2.0

0. Bible for new maintainers packaging .deb's: ~/nco/debian/maint-guide.en.ps

1. Install Debian packages required to build new packages
apt-get install dh-make debhelper devscripts fakeroot gnupg debian-policy developers-reference

2. Debian build procedure recommends placing entire package source in
   subdirectory of main package. 
   For starters, we wish to create .debs of tagged releases, e.g., nco-2.7.3
   First we create a clean source distribution of nco and place it in nco-2.7.3
   Once automated, we will use cvs co -rnco-2_7_3 to get the source
   Until we know what is necessary, however, we just copy a snapshot
   
   2.1 Clean all build files from development directory

cd ~/nco;make distclean;cd bld;make clean;cd ~
tar cvzf ./nco/nco.tar.gz ./nco/*
cd ~/nco;tar xvzf nco.tar.gz;mv nco nco-2.7.3
/bin/rm nco.tar.gz;tar cvzf nco-2.7.3.tar.gz ./nco-2.7.3/*
cd ~/nco/nco-2.7.3
dh_make -e zender@uci.edu -f ../nco-2.7.3.tar.gz # Create Debian package template
... # Edit files in ~/nco/debian

    2.2 The preceding steps created template debian files for a .deb,
    Those files now reside in ~/nco/debian.
    They are checked into the CVS repository of the main distribution

3. 
cd ~/nco/nco-2.7.3
dpkg-buildpackage -rfakeroot # Build .deb package

# Create Debian tree from nco_2.2.0-3.dsc nco_2.2.0-3.orig.tar.gz, nco_2.2.0-3.diff.gz 
dpkg-source -x nco_2.2.0-3.dsc
# Previous dpkg-source command is functionally equivalent to following
# Apply Debian diff to original source to produce Debian source
cd /data/zender;/bin/rm -r nco-2.2.0.orig nco-2.2.0 
tar xvzf nco_2.2.0.orig.tar.gz # Untar original source
cp -r nco-2.2.0.orig nco-2.2.0 # Create destination for patches
patch -p0 < nco_2.2.0-3.diff # Patch destination with Debian diff


